#include "LedControl.h"

#include <SotfwareSerial.h>

int ThermistorPin = 0;

int Vo;

float R1 = 10000;

float logR2, R2, T;

float c1 = 1.009249522e-03, c2 = 2.378405444e-04, c3 = 2.019202697e-07;

LedControl lc = LedControl(12, 11, 10, 2); // Pin and # of Displays

//LedControl(int dataPin, int clkPin, int csPin, int numDevices);

unsigned long delayTime = 1000; // Delay between Frames


byte Min[8]={ //M-
        B00000000,
        B00000111,
        B00000000,
        B00100100,
        B01011010,
        B01000010,
        B01000010,
        B01000010};

byte Max[8]={ //M+
        B00000010,
        B00000111,
        B00000010,
        B00100100,
        B01011010,
        B01000010,
        B01000010,
        B01000010};


byte tableOfNumbers[99] [8] =

{ {
    B00000000, // zero
    B00000111,
    B00000101,
    B00000101,
    B00000101,
    B00000111,
    B00000000,
    B00000000
  } ,

  {

    B00000000, // one

    B00000010,

    B00000110,

    B00000010,

    B00000010,

    B00000111,

    B00000000,
    
    B00000000

  }

  ,

  {

    B00000000, // two

    B00000111,

    B00000001,

    B00000111,

    B00000100,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // tree

    B00000111,

    B00000001,

    B00000111,

    B00000001,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // four

    B00000101,

    B00000101,

    B00000111,

    B00000001,

    B00000001,

    B00000000,

    B00000000

  },

  {

    B00000000, // five

    B00000111,

    B00000100,

    B00000111,

    B00000001,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // six

    B00000110,

    B00000100,

    B00000111,

    B00000101,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // seven

    B00000111,

    B00000001,

    B00000111,

    B00000010,

    B00000100,

    B00000000,

    B00000000

  },

  {

    B00000000, // eight

    B00000111,

    B00000101,

    B00000111,

    B00000101,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // nine

    B00000111,

    B00000101,

    B00000111,

    B00000001,

    B00000111,

    B00000000,

    B00000000

  },

  {

    B00000000, // ten

    B00100111,

    B01100101,

    B00100101,

    B00100101,

    B01110111,

    B00000000,
    
    B00000000

  }

  ,

  {

    B00000000, // eleven

    B00100010,

    B01100110,

    B00100010,

    B00100010,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // twelve

    B00100111,

    B01100001,

    B00100111,

    B00100100,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 13

    B00100111,

    B01100001,

    B00100111,

    B00100001,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 14

    B00100101,

    B01100101,

    B00100111,

    B00100001,

    B01110001,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 15

    B00100111,

    B01100100,

    B00100111,

    B00100001,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 16

    B00100110,

    B01100100,

    B00100111,

    B00100101,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 17

    B00100111,

    B01100001,

    B00100111,

    B00100010,

    B01110100,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 18

    B00100111,

    B01100101,

    B00100111,

    B00100101,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // 19

    B00100111,

    B01100101,

    B00100111,

    B00100001,

    B01110111,

    B00000000,
    
    B00000000

  },

  {

    B00000000, // twenty

    B01110111,

    B00010101,

    B01110101,

    B01000101,

    B01110111,

    B00000000,

    B00000000

  } ,

  {

    B00000000, // 21

    B01110010,

    B00010110,

    B01110010,

    B01000010,

    B01110111,

    B00000000,
    
    B00000000

  }

  ,

  {

    B00000000, // twenty two

    B01110111,

    B00010001,

    B01110111,

    B01000100,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 23

    B01110111,

    B00010001,

    B01110111,

    B01000001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 24

    B01110101,

    B00010101,

    B01110111,

    B01000001,

    B01110001,

    B00000000,

    B00000000

  },

  {

    B00000000, // 25

    B01110111,

    B00010100,

    B01110111,

    B01000001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 26

    B01110110,

    B00010100,

    B01110111,

    B01000101,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 27

    B01110111,

    B00010001,

    B01110111,

    B01000010,

    B01110100,

    B00000000,

    B00000000

  },

  {

    B00000000, // 28

    B01110111,

    B00010101,

    B01110111,

    B01000101,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 29

    B01110111,

    B00010101,

    B01110111,

    B01000001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // Thety

    B01110111,

    B00010101,

    B01110101,

    B00010101,

    B01110111,

    B00000000,

    B00000000

  } ,

  {

    B00000000, // 31

    B01110010,

    B00010110,

    B01110010,

    B00010010,

    B01110111,

    B00000000

  }

  ,

  {

    B00000000, // 32

    B01110111,

    B00010001,

    B01110111,

    B00010100,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 33

    B01110111,

    B00010001,

    B01110111,

    B00010001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 34

    B01110101,

    B00010101,

    B01110111,

    B00010001,

    B01110001,

    B00000000,

    B00000000

  },

  {

    B00000000, // 35

    B01110111,

    B00010100,

    B01110111,

    B00010001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 36

    B01110110,

    B00010100,

    B01110111,

    B00010101,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 37

    B01110111,

    B00010001,

    B01110111,

    B00010010,

    B01110100,

    B00000000,

    B00000000

  },

  {

    B00000000, // 38

    B01110111,

    B00010101,

    B01110111,

    B00010101,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 39

    B01110111,

    B00010101,

    B01110111,

    B00010001,

    B01110111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 40

    B01010111,

    B01010101,

    B01110101,

    B00010101,

    B00010111,

    B00000000,

    B00000000

  } ,

  {

    B00000000, // 41

    B01010010,

    B01010110,

    B01110010,

    B00010010,

    B00010111,

    B00000000

  }

  ,

  {

    B00000000, // 42

    B01010111,

    B01010001,

    B01110111,

    B00010100,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 43

    B01010111,

    B01010001,

    B01110111,

    B00010001,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B0000000, // 44

    B01010101,

    B01010101,

    B01110111,

    B00010001,

    B00010001,

    B00000000,

    B00000000

  },

  {

    B00000000, // 45

    B01010111,

    B01010100,

    B01110111,

    B00010001,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 46

    B01010110,

    B01010100,

    B01110111,

    B00010101,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 47

    B01010111,

    B01010001,

    B01110111,

    B00010010,

    B00010100,

    B00000000,

    B00000000

  },

  {

    B00000000, // 48

    B01010111,

    B01010101,

    B01110111,

    B00010101,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 49

    B01010111,

    B01010101,

    B01110111,

    B00010001,

    B00010111,

    B00000000,

    B00000000

  },

  {

    B00000000, // 50

    B01110111,

    B01000101,

    B01110101,

    B00010101,

    B01110111,

    B00000000,

    B00000000

  } ,

  {

    B00000000, // 51

    B01110010,

    B01000110,

    B01110010,

    B00010010,

    B01110111,

    B00000000,
    
    B00000000

  }
  ,

  {

    B00000000, // 52

    B01110111,

    B01000001,

    B01110111,

    B00010100,

    B01110111,

    B00000000,
    
    B00000000

  },
  {
    B00000000, // 53

    B01110111,

    B01000001,

    B01110111,

    B00010001,

    B01110111,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 54

    B01110101,

    B01000101,

    B01110111,

    B00010001,

    B01110001,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 55

    B01110111,

    B01000100,

    B01110111,

    B00010001,

    B01110111,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 56

    B01110110,

    B01000100,

    B01110111,

    B00010101,

    B01110111,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 57

    B01110111,

    B01000001,

    B01110111,

    B00010010,

    B01110100,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 58

    B01110111,

    B01000101,

    B01110111,

    B00010101,

    B01110111,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 59

    B01110111,

    B01000101,

    B01110111,

    B00010001,

    B01110111,

    B00000000,
    
    B00000000
  },
  {
    B00000000, // 60

    B01100111,

    B01000101,

    B01110101,

    B01010101,

    B01110111,

    B00000000,
    
    B00000000
  }
}

;



void setup()
{
  Serial.begin(9600);
  Serial.println("hello, setup .");
  lc.shutdown(0, false); // Wake up displays
  lc.setIntensity(0, 10); // Set intensity levels
  lc.clearDisplay(0);  // Clear Displays
}





//  Take values in Arrays and Display them





void displayNumberOnLC( char theNumber)
{
  for (int i = 0; i < 8; i++)
  {
    lc.setRow(0, i, tableOfNumbers[theNumber][i]);
  }
}

/********************/

void loop()
{
  Vo = analogRead(ThermistorPin);
  R2 = R1 * (1023.0 / (float)Vo - 1.0);
  logR2 = log(R2);
  T = (1.0 / (c1 + c2 * logR2 + c3 * logR2 * logR2 * logR2));
  T = T - 273.15;
  // T = (T * 9.0)/ 5.0 + 32.0;
  Serial.print("Temp = ");
  Serial.print(T);
  Serial.print(" C");
  Serial.println();
  if (T <= 0){
      for (int i = 0; i < 8; i++)
      {  
        lc.setRow(0, i, Min[i]);
      }
    }
  else{
    if(T > 60){
      for (int i = 0; i < 8; i++)
      {
        lc.setRow(0, i, Max[i]);
      }
    }
    else{
      displayNumberOnLC(T);
      }
  }
  delay(delayTime); //a delay just for stabiiliity
}
